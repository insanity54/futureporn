{% extends "layouts/base.njk" %}

{% block head %}
  {{ super() }}
  <link rel="stylesheet" href="/@includes/styles/player.scss">
{% endblock %}


{% block content %}
  <div class="container">


 
   <div class="block">
    {% island 'VideoPlayer.svelte', 'client:load' %}
    {% prop 'videoSrcHash', vod.attributes.videoSrcHash | stripQueryString %}
    {% prop 'video720Hash', vod.attributes.video720Hash | stripQueryString %}
    {% prop 'video360Hash', vod.attributes.video360Hash | stripQueryString %}
    {% prop 'video240Hash', vod.attributes.video240Hash | stripQueryString %}
    {% prop 'thiccHash', vod.attributes.thiccHash | stripQueryString %}
    {% endisland %}
    {# <video 
      id="my-player" 
      class="video-js vjs-16-9 vjs-theme-fantasy" 
      controls 
      preload="auto" 
      width="100%"
      data-setup='{
        "timelineHoverPreviews": true,
        "plugins": {
          "httpSourceSelector": {
            default: "low"
          }
        }
      }'
    >
      

      {%- if vod.attributes.videoSrcHash %}
      <source src="{{ vod.attributes.videoSrcHash | buildIpfsUrl }}" type="video/mp4" />
      {% endif %}

      {%- if vod.attributes.videoSrcHash %}
      <source src="{{ vod.attributes.video240Hash | buildIpfsUrl }}" type="video/mp4" />
      {% endif %}

    </video> #}
  </div>


  <div class="block">
    <div class="box">
      <p class="heading">IPFS Gateway Selector</p>

      {% island 'GatewaySelector.svelte', 'client:load' %}
      {% prop 'freeGateways', gateways.free %}
      {% prop 'premiumGateways', gateways.premium %}
      {% endisland %}

    </div>
  </div>


  <div class="block">


    <div class="box">

      <h2 class="subtitle mb-0">
        {%- if vod.attributes.announceTitle %}
        {{ vod.attributes.announceTitle }}
        {% elif vod.attributes.title %}
        {{ vod.attributes.title }}
        {% endif %}
        
      </h2>
        {% if vod.attributes.date %}
          <p class="mt-0 mb-5">{{ vod.attributes.date | readableDate }}</p>
        {% endif %}


      <h2 class="heading">
        Download Links
      </h2>

      
      <div class="mb-5">

        <ul class="mb-5">
          {%- if vod.attributes.videoSrcHash %}
          <li>
            <span>
              Source: {% island 'IpfsLink.svelte', 'client:load' %}
              {% prop 'cid', vod.attributes.videoSrcHash | stripQueryString %}
              {% endisland %}
            </span>
          </li>
          {% endif %}

          {%- if vod.attributes.video720Hash %}
          <li><span>720p: {% island 'IpfsLink.svelte', 'client:load' %}
              {% prop 'cid', vod.attributes.video720Hash | stripQueryString %}
              {% endisland %}</span></li>
          {% endif %}
          {%- if vod.attributes.video480Hash %}
          <li><span>480p: {% island 'IpfsLink.svelte', 'client:load' %}
              {% prop 'cid', vod.attributes.video480Hash | stripQueryString %}
              {% endisland %}</span></li>
          {% endif %}
          {%- if vod.attributes.video360Hash %}
          <li><span>360p: {% island 'IpfsLink.svelte', 'client:load' %}
              {% prop 'cid', vod.attributes.video360Hash | stripQueryString %}
              {% endisland %}</span></li>
          {% endif %}

          {%- if vod.attributes.video240Hash %}
            <li>
              <span>240p: {% island 'IpfsLink.svelte', 'client:load' %}
              {% prop 'cid', vod.attributes.video240Hash | stripQueryString %}
              {% endisland %}
              </span>
            </li>
          {% endif %}
        </ul>
      </div>


      <h2 class="heading">IPFS Content IDs</h2>

      <ul>
        {%- if vod.attributes.videoSrcHash %}
          <li><span>Source: <span class="tag">{{ vod.attributes.videoSrcHash | stripQueryString }}</span></span></li>
        {% endif %}
        {%- if vod.attributes.video720Hash %}
          <li><span>Source: <span class="tag">{{ vod.attributes.video720Hash | stripQueryString }}</span></span></li>
        {% endif %}
        {%- if vod.attributes.video480Hash %}
          <li><span>Source: <span class="tag">{{ vod.attributes.video480Hash | stripQueryString }}</span></span></li>
        {% endif %}
        {%- if vod.attributes.video360Hash %}
          <li><span>Source: <span class="tag">{{ vod.attributes.video360Hash | stripQueryString }}</span></span></li>
        {% endif %}
        {%- if vod.attributes.video240Hash %}
          <li><span>240p: <span class="tag">{{ vod.attributes.video240Hash | stripQueryString }}</span></span></li>
        {% endif %}
      </ul>


      {%- if vod.attributes.announceUrl %}
        <div class="mb-5">
          <h2 class="mt-3 heading">Stream Annoucement URL</h2>
          <a href="{{ vod.attributes.announceUrl }}">{{ vod.attributes.announceUrl }}</a>
        </div>
      {% endif %}

      {# 
        tags coming soon
        {%- if vod.attributes.tags %}
        <div class="mb-5">
          <h2 class="mt-3 heading">Tags</h2>
          {%- for tag in vod.attributes.tags %}
            <a href="/tags/{{ tag }}">{{ tag }}</a>
          {% endfor -%}
        </div>
      {% endif %} #}


      {%- if vod.attributes.note %}
        <div class="mb-3">
          <h2 class="heading">Note</h2>
          <p>{{ vod.attributes.note }}</p>
        </div>
      {% endif %}

      <hr>
        
      <div class="level">
        {% if pagination.href.previous %}
          <p>Prev Vod:
          <a 
          href="{{ pagination.href.previous }}">{{ pagination.page.previous.title or pagination.page.previous.announceTitle }}</a>
          </p>
        {% endif %}
        {% if pagination.href.next %}
          <p>Next Vod:
          <a 
          href="{{ pagination.href.next }}">{{ pagination.page.next.title or pagination.page.next.announceTitle }}
          </a>
          </p>
        {% endif %}

      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block footer %}
  {{ super() }}
{% endblock %}

{% block scripts %}
  {{ super() }}
  {# <script type="text/javascript" src="/@root/node_modules/@mux/videojs-kit/dist/index.js"></script> #}
  {# <script type="module" src="/@includes/js/player.js"></script> #}
  <script src="plyr/dist/plyr.js"></script>
{% endblock %}


{% block end %}
  {{ super() }}
{% endblock %}